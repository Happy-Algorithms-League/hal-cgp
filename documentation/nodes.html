

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Nodes &mdash; hal-cgp 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/msmb.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/js/versions.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Searching numerical values for parameters via local search" href="local_search.html" />
    <link rel="prev" title="Populations and individuals" href="population_individual.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> hal-cgp
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../basic_usage.html">Basic usage</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="documentation.html">Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="population_individual.html">Populations and individuals</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Nodes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#default-nodes-in-hal-cgp">Default nodes in hal-cgp</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-nodes">Custom nodes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="local_search.html">Searching numerical values for parameters via local search</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../auto_examples/index.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_reference/api_reference.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation.html">Citation</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">hal-cgp</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="documentation.html">Documentation</a> &raquo;</li>
        
      <li>Nodes</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/documentation/nodes.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="nodes">
<h1>Nodes<a class="headerlink" href="#nodes" title="Permalink to this headline">¶</a></h1>
<p>Nodes define the buildings blocks of the mathematical expressions represented by an individual.
They are represented in the invididual’s genome (see <a class="reference internal" href="population_individual.html#pop-ind"><span class="std std-ref">Populations and individuals</span></a>).</p>
<p>A node receives data from a certain number of input nodes (specified by its <cite>arity</cite> which can be any non-negative number) and transforms them into one output value. A priori, there are no limitations regarding the type of transformation, as long as it can be expressed in pure Python, <a class="reference external" href="https://www.sympy.org">SymPy</a>, <a class="reference external" href="https://pytorch.org">PyTorch</a>, and <a class="reference external" href="https://numpy.org">NumPy</a>.</p>
<section id="default-nodes-in-hal-cgp">
<h2>Default nodes in hal-cgp<a class="headerlink" href="#default-nodes-in-hal-cgp" title="Permalink to this headline">¶</a></h2>
<p>hal-cgp comes with a set of implemented nodes:</p>
<ul class="simple">
<li><p>The <cite>InputNode</cite> and <cite>OutputNode</cite> are special nodes that represent the input to and output from the computational graph.</p></li>
<li><p>A set of basic mathematical operations is implemented as <cite>OperatorNodes</cite>: addition (<code class="docutils literal notranslate"><span class="pre">Add</span></code>), subtraction (<code class="docutils literal notranslate"><span class="pre">Sub</span></code>), multiplication (<code class="docutils literal notranslate"><span class="pre">Mul</span></code>), division (<code class="docutils literal notranslate"><span class="pre">Div</span></code>) and power (<code class="docutils literal notranslate"><span class="pre">Pow</span></code>).</p></li>
<li><p>A <cite>ConstantFloat</cite> that represents a constant in mathematical expressions.</p></li>
<li><p>A <cite>ParameterNode</cite> that represents an adjustable parameter (see <a class="reference internal" href="local_search.html#local-search"><span class="std std-ref">Searching numerical values for parameters via local search</span></a>).</p></li>
</ul>
</section>
<section id="custom-nodes">
<h2>Custom nodes<a class="headerlink" href="#custom-nodes" title="Permalink to this headline">¶</a></h2>
<p>In hal-cgp, it is straightforward to implement new, custom nodes.
The custom nodes needs to be implemented as a subclass of the <cite>OperatorNode</cite> (<a class="reference internal" href="../api_reference/nodes.html#cgp.node.OperatorNode" title="cgp.node.OperatorNode"><code class="xref py py-meth docutils literal notranslate"><span class="pre">cgp.node.OperatorNode()</span></code></a>) and define its <code class="docutils literal notranslate"><span class="pre">arity</span></code> as well as its transformation, defined by the <code class="docutils literal notranslate"><span class="pre">_def_output</span></code> member of the class. The <code class="docutils literal notranslate"><span class="pre">_def_output</span></code> string defines the transformation in pure Python and is used to automatically define the transformation in <a class="reference external" href="https://www.sympy.org">SymPy</a>, <a class="reference external" href="https://pytorch.org">PyTorch</a>, and <a class="reference external" href="https://numpy.org">Numpy</a>. In this string <cite>x_i</cite> refers to the <a href="#id1"><span class="problematic" id="id2">`</span></a>i`th input to the node.</p>
<p>As a simple example, we implement a custom node that doubles its input:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cgp</span>

<span class="k">class</span> <span class="nc">Double</span><span class="p">(</span><span class="n">cgp</span><span class="o">.</span><span class="n">OperatorNode</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A node that doubles its input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_arity</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_def_output</span> <span class="o">=</span> <span class="s2">&quot;2*x_0&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>If the representation of the transformation in <a class="reference external" href="https://www.sympy.org">SymPy</a>, <a class="reference external" href="https://pytorch.org">PyTorch</a>, or <a class="reference external" href="https://numpy.org">NumPy</a> differs from pure Python, we need to define dedicated expressions via the <cite>_def_X_output</cite> members. For instance, to implement a node that computes the exponential of an input, we define the same operation in four different expressions:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cgp</span>

<span class="k">class</span> <span class="nc">Exp</span><span class="p">(</span><span class="n">cgp</span><span class="o">.</span><span class="n">OperatorNode</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A node that calculates the exponential of its input.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_arity</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_def_output</span> <span class="o">=</span> <span class="s2">&quot;math.exp(x_0)&quot;</span>
    <span class="n">_def_numpy_output</span> <span class="o">=</span> <span class="s2">&quot;np.exp(x_0)&quot;</span>
    <span class="n">_def_torch_output</span> <span class="o">=</span> <span class="s2">&quot;torch.exp(x_0)&quot;</span>
    <span class="n">_def_sympy_output</span> <span class="o">=</span> <span class="s2">&quot;exp(x_0)&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>We can make this custom mode more flexible by adding an adjustable parameter for the scale of the exponential. Parameter names are enclosed by angle brackets in the expressions. Furthermore, each parameter requires a function that returns its initial values to be defined in the <cite>_initial_values</cite> dict.
We add the <code class="docutils literal notranslate"><span class="pre">&lt;scale&gt;</span></code> term in the expressions and define its initial value in the <code class="docutils literal notranslate"><span class="pre">_initial_values</span></code> class member:</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cgp</span>

<span class="k">class</span> <span class="nc">ExpScaled</span><span class="p">(</span><span class="n">cgp</span><span class="o">.</span><span class="n">OperatorNode</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A node that calculates the exponential of its input. An adjustable</span>
<span class="sd">    parameter governs the scale.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_arity</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">_initial_values</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;&lt;scale&gt;&quot;</span><span class="p">:</span> <span class="k">lambda</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
    <span class="n">_def_output</span> <span class="o">=</span> <span class="s2">&quot;math.exp(&lt;scale&gt; * x_0)&quot;</span>
    <span class="n">_def_numpy_output</span> <span class="o">=</span> <span class="s2">&quot;np.exp(&lt;scale&gt; * x_0)&quot;</span>
    <span class="n">_def_torch_output</span> <span class="o">=</span> <span class="s2">&quot;torch.exp(&lt;scale&gt; * x_0)&quot;</span>
    <span class="n">_def_sympy_output</span> <span class="o">=</span> <span class="s2">&quot;exp(&lt;scale&gt; * x_0)&quot;</span>
</pre></div>
</div>
</div></blockquote>
<p>For a complete example that uses custom nodes with adjustable parameters, please refer to <a class="reference internal" href="../auto_examples/example_parametrized_nodes.html#sphx-glr-auto-examples-example-parametrized-nodes-py"><span class="std std-ref">Example for evolutionary regression with parametrized nodes</span></a>.</p>
</section>
</section>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="local_search.html" class="btn btn-neutral float-right" title="Searching numerical values for parameters via local search" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="population_individual.html" class="btn btn-neutral float-left" title="Populations and individuals" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Happy Algorithms League.

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  <script>
    var versions_json_url = ''
</script>

<div class="rst-versions" data-toggle="rst-versions" role="note"
     aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"></span>
        0.2.0
      <span class="fa fa-caret-down"></span>
    </span>

    <div class="rst-other-versions">
        <dl id="versionselector">
            <dt>Other Versions</dt>
        </dl>

    </div>
</div>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>